//-----------------------------------------------------------------------------
// Title         : Elementary Operation
// Project       : smaller_accel
//-----------------------------------------------------------------------------
// File          : addsub.sv
// Author        : kazuki  <kazuki@kz-desk>
// Created       : 25.08.2020
// Last modified : 25.08.2020
//-----------------------------------------------------------------------------
// Description :
// 
//-----------------------------------------------------------------------------
// Copyright (c) 2020 by  This model is the confidential and
// proprietary property of  and the possession or use of this
// file requires a written license from .
//------------------------------------------------------------------------------
// Modification history :
// 25.08.2020 : created
//-----------------------------------------------------------------------------

`include "AXIS.sv"

module geo_iray
  (
   input [31:0] iray_start,
   output [31:0] iray,
   output iray_valid,
   AXIS mul
   );
    
    assign mul.r_tready = 1;    
    assign add.r_tready = 1;
    
     assign  add.aclk     = mul.aclk    ;
     assign  add.a_tdata  = iray_start  ;
     assign  add.a_tvalid = mul.r_tvalid;
     assign  add.b_tdata  = mul.r_tdata ;
     assign  add.b_tvalid = mul.r_tvalid;
     assign  iray         = add.r_tdata ;
     assign  iray_valid   = add.r_tvalid;

    initial begin
        mul.a_tvalid = 0;
        mul.b_tvalid = 0;
        add.a_tvalid = 0;        
        add.b_tvalid = 0;
    end
    
    geo_mul geo_mul_0
      (
       .aclk(mul.aclk),
       .s_axis_a_tdata(mul.a_tdata),
       .s_axis_a_tready(mul.a_tready),
       .s_axis_a_tvalid(mul.a_tvalid),
       .s_axis_b_tdata(mul.b_tdata),
       .s_axis_b_tready(mul.b_tready),
       .s_axis_b_tvalid(mul.b_tvalid),
       .m_axis_result_tdata(mul.r_tdata),
       .m_axis_result_tvalid(mul.r_tvalid),
       .m_axis_result_tready(mul.r_tready)
       );
    
    geo_add geo_add_0
      (
       .aclk(add.aclk),
       .s_axis_a_tdata(add.a_tdata),
       .s_axis_a_tready(add.a_tready),
       .s_axis_a_tvalid(add.a_tvalid),
       .s_axis_b_tdata(add.b_tdata),
       .s_axis_b_tready(add.b_tready),
       .s_axis_b_tvalid(add.b_tvalid),
       .m_axis_result_tdata(add.r_tdata),
       .m_axis_result_tvalid(add.r_tvalid),
       .m_axis_result_tready(add.r_tready)
    );

endmodule
       
